#!/bin/sh
#
#  (c) 2018-2022 m4r35n357@gmail.com (Ian Smith), for licencing see the LICENCE file

echo "CNS duration vs Integrator Order: [$*]" >&2

max=$1
threshold=$2
shift 2
original=$*

. ./cns-functions.sh

n=2
while [ $n -le $max ]
do
    set $original
    begin="$1 $2"
    shift 3
    current="$begin $n $*"
    halfstep $current
    $current >$fileB & wait
    temp=$(./divergence $fileA $fileB $threshold)
    if [ x$temp = x'' ]
    then
        echo $n -1
    else
        set $temp
        echo $n $4 $6
    fi
    n=$((n + 1))
done 2>/dev/null
exit 0
