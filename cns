#!/bin/sh
#
#  (c) 2018-2020 m4r35n357@gmail.com (Ian Smith), for licencing see the LICENCE file
#
# time -p ./cns data plot ./tsm-lorenz-static 9 130 102 .01 35000 -15.8 -17.48 35.64 10 28 8 3     # (300 Lorenz time units)
# time -p ./cns data plot ./tsm-lorenz-static 9 240 204 .01 65000 -15.8 -17.48 35.64 10 28 8 3     # (600 Lorenz time units)
# time -p ./cns data plot ./tsm-lorenz-static 9 800 501 .005 150000 -15.8 -17.48 35.64 10 28 8 3   #(1500 Lorenz time units)

fileA='/tmp/dataA'  # the "better" simulation, or data file
fileB='/tmp/dataB'  # the original simulation

method=$1
plot=$2
shift 2
original=$*

. ./cns-functions.sh

case $method in
     'step') quarterstep $original;;
    'order') orderplus2 $original;;
     'both') orderstep $original;;
     'data') cp d-best $fileA; chmod u+w $fileA;;
    'nosim') ;;  # replot existing data
          *) echo "CNS: Bad Method"; exit 1;;
esac
case $method in
    'nosim') ;;
          *) $original >$fileB & wait;;
esac

./divergence.py $fileA $fileB 3 0.000000000001 0.000000001 0.000001 0.001 1.0

if [ "x$plot" = "xplot" ]
then
    ./compare.py $fileA $fileB 3 >/dev/null &
    ./plot3d.py $fileA $fileB >/dev/null 2>&1 &
fi

