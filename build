#!/bin/sh

# Copyright (c) 2018-2020, Ian Smith (m4r35n357)
# All rights reserved.
# For licencing see LICENCE file

WARNINGS='-pedantic -Wall -Wshadow -Wpointer-arith -Wcast-qual -Wstrict-prototypes -Wmissing-prototypes -Wextra'

CC='/usr/bin/musl-gcc -std=c99'
if [ x"$1" = x'clang' ]
then
    CC='/usr/bin/clang'
elif [ x"$1" = x'gcc' ]
then
    CC='/usr/bin/c99'
fi
${CC} --version

rm -f *.o *.so *.gch

build () {
    name=$1
    ${CC} -O3 -DNDEBUG -static -o ${name}-static ${name}.c taylor-ode.c -lm -s
    ${CC} -O0 $WARNINGS -g -o ${name}-dbg ${name}.c taylor-ode.c -lm
}

for model in \
rk4-bouali \
rk4-halvorsen \
rk4-lorenz \
rk4-rossler \
rk4-rucklidge \
rk4-rf \
rk4-thomas \
rk4-sprott-thomas \
rk4-wimol-banlue \
rk4-yu-wang \
tsm-bouali \
tsm-halvorsen \
tsm-lorenz \
tsm-rossler \
tsm-genesio-tesi \
tsm-rucklidge \
tsm-rf \
tsm-thomas \
tsm-sprott-minimal \
tsm-sprott-thomas \
tsm-sj \
tsm-wimol-banlue \
tsm-yu-wang
do
    rm -f ${model}-*
    build ${model} &
done

wait
ls -lh --color tsm-* rk4-*

