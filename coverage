#!/bin/sh

C_OUT_DIR='coverage-out'
C_OUT_FILE='coverage.info'

c99 --coverage -O0 -o libad-test-dbg libad-test.c ad.c taylor-ode.c -lmpfr
./libad-test-dbg 237 64 -.5 1e-64 >/dev/null
./libad-test-dbg 237 64 0 1e-64 >/dev/null
./libad-test-dbg 237 64 .5 1e-64 >/dev/null
./libad-test-dbg 237 64 1 1e-67 2 >/dev/null

lcov --capture --directory . --output-file $C_OUT_FILE
genhtml $C_OUT_FILE --output-directory $C_OUT_DIR

echo "C:      file://$(pwd)/$C_OUT_DIR/index.html"
